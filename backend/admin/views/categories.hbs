<h2 class="mb-4 fw-bold text-primary">
  <i class="bi bi-tags"></i> Categories Management
</h2>

<div class="mb-3 d-flex flex-wrap justify-content-between align-items-center">
  <a href="/categories/add" class="btn btn-success shadow-sm mb-2">
    <i class="bi bi-plus-circle"></i> Add Category
  </a>
  <input type="text" id="categorySearch" class="form-control" placeholder="Search categories..." style="max-width: 300px;" oninput="filterCategories()">
</div>

<div class="card shadow-sm">
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0" id="categoriesTable">
        <thead class="table-primary">
          <tr>
            <th>#</th>
            <th>Image</th>
            <th>Name</th>
            <th>Products</th>
            <th style="min-width:120px;">Actions</th>
          </tr>
        </thead>
        <tbody>
          {{#if categories.length}}
            {{#each categories}}
            <tr>
              <td>{{this.id}}</td>
              <td>
                {{#if this.imageUrl}}
                  <img src="{{this.imageUrl}}" alt="{{this.name}}" style="width:48px; height:48px; object-fit:cover; border-radius:6px; border:1px solid #eee;">
                {{else}}
                  <span class="text-muted">No image</span>
                {{/if}}
              </td>
              <td class="fw-semibold">{{this.name}}</td>
              <td>
                {{#if this.productsCount}}
                  <span class="badge bg-info">{{this.productsCount}}</span>
                {{else}}
                  <span class="text-muted">0</span>
                {{/if}}
              </td>
              <td>
                <a href="/categories/{{this.id}}/edit" class="btn btn-sm btn-primary me-1">
                  <i class="bi bi-pencil"></i> Edit
                </a>
                <form action="/categories/{{this.id}}/delete" method="POST" style="display:inline;">
                  <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Delete this category?')">
                    <i class="bi bi-trash"></i>
                  </button>
                </form>
              </td>
            </tr>
            {{/each}}
          {{else}}
            <tr>
              <td colspan="5" class="text-center text-muted">No categories found.</td>
            </tr>
          {{/if}}
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Bootstrap 5 Icons (if not already included in your layout) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

<script>
function filterCategories() {
  const input = document.getElementById('categorySearch').value.toLowerCase();
  const rows = document.querySelectorAll('#categoriesTable tbody tr');
  rows.forEach(row => {
    const text = row.textContent.toLowerCase();
    row.style.display = text.includes(input) ? '' : 'none';
  });
}
</script>

<style>
body {
  background: #f6f7fb;
}
.card {
  margin-top: 32px;
  border-radius: 12px;
}
.table th, .table td {
  vertical-align: middle;
}
.badge {
  font-size: 0.95em;
}
#categorySearch:focus {
  box-shadow: 0 0 0 0.15rem #0d6efd33;
  border-color: #0d6efd;
}
</style>
